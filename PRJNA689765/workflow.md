
# 工作流程文档

本文档详细记录了从一篇关于白色念珠菌的科学论文中提取、验证和总结元数据的完整工作流程。

## 步骤 1: 从PDF补充文件中初步提取元数据

1.  **数据来源**: 工作流程始于一个PDF格式的科学论文的补充材料文件 (`spectrum.03807-22-s0002.tsv`)。
2.  **提取标准**: 目标是提取满足以下两个条件的白色念珠菌菌株信息：
    *   基因组测序数据已公开发布到NCBI数据库。
    *   菌株已经过抗真菌药物敏感性测试，并有明确的耐药性指标。
3.  **提取字段**: 针对每个符合条件的菌株，提取了以下元数据字段：
    *   参考标识符 (文献DOI)
    *   菌株唯一编号
    *   NCBI登录号 (此阶段为空)
    *   菌株来源
    *   地理位置
    *   收集日期 (此阶段为空)
    *   测序方法 (此阶段为空)
    *   抗真菌药敏试验中的药物
    *   药敏指标类型 (MIC)
    *   耐药性值
    *   药敏标准 (CLSI)
    *   测试方法 (肉汤微量稀释法)
    *   培养条件
4.  **输出**: 提取的数据被编译成一个JSON数组，并以中文保存到 `metadata_initial.json` 文件中。

## 步骤 2: 从NCBI智能获取元数据

1.  **输入**: 使用一个包含NCBI SRA登录号列表的文本文件 `accession.txt`。
2.  **工具**: 利用Entrez Direct命令行工具中的 `efetch` 命令。
3.  **过程**:
    *   `efetch` 命令以 `accession.txt` 文件作为输入，从NCBI的SRA数据库中批量获取每个登录号对应的元数据。
    *   获取的数据格式为XML，并保存为 `sra_metadata.xml` 文件。

## 步骤 3: 规划验证方案

在执行验证之前，制定了详细的计划以确保数据的准确性和一致性。

*   **菌株数量验证**: 计划比较 `metadata_initial.json` 中的菌株数量和 `sra_metadata.xml` 中的记录数量。
*   **内容一致性验证**: 计划逐个字段地比对两个文件中的信息，特别是 `NCBI登录号`、`地理位置`、`收集日期` 和 `测序方法`。

## 步骤 4: 执行验证并更新JSON文件

这是整个工作流程中最关键的一步，确保了数据的最终质量。

1.  **脚本执行**: 运行一个Python脚本 (`verify_and_update.py`)，该脚本负责解析 `sra_metadata.xml` 文件和 `metadata_initial.json` 文件。
2.  **数据交叉引用与映射**:
    *   脚本的核心功能是解析 `sra_metadata.xml` 文件，以建立 `菌株唯一编号` 和 `NCBI登录号` 之间的精确映射。
    *   具体实现上，脚本遍历XML文件中的每个 `<EXPERIMENT_PACKAGE>`。在每个包中，它提取出 `<EXPERIMENT>` 标签的 `alias` 属性（该属性对应于 `菌株唯一编号`），以及 `<RUN>` 标签的 `accession` 属性（对应于 `NCBI登录号`）。
    *   通过这种方式，脚本创建了一个从菌株编号到其对应NCBI登录号的字典或映射表。
3.  **填充与更新**:
    *   脚本随后遍历 `metadata_initial.json` 文件中的每个菌株记录。
    *   利用上一步创建的映射表，通过 `菌株唯一编号` 查找到对应的 `NCBI登录号`，并将其填充到相应的字段中。
4.  **生成最终文件**: 经过验证和更新的数据被写入一个新的文件 `metadata_verified.json`。该文件包含了最准确、最完整的元数据，并以中文格式保存。

## 步骤 5: 创建科学背景摘要

1.  **上下文理解**: 重新阅读原始PDF论文，以深入理解研究的科学背景。
2.  **核心问题**: 回答了论文的核心科学问题：“对这组已测序的菌株进行抗真菌药敏试验，旨在研究什么科学问题？”
3.  **输出**: 将答案以简洁的摘要形式写入 `science_background.md` 文件中，并以中文呈现。

## 步骤 6: 记录工作流程

本文档本身即为工作流程的最终产物，旨在清晰、透明地展示从数据提取到最终分析的每一步操作。
